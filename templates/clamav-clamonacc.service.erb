[Unit]
Description=ClamAV On-Access Scanner
Documentation=man:clamonacc(8) man:clamd.conf(5) https://www.clamav.net/documents/on-access-scanning
Requires=clamav-daemon.service
After=clamav-daemon.service syslog.target network.target

[Service]
Type=simple
User=root
ExecStartPre=/bin/bash -c "while [ ! -S <%= scope['clamav::clamd_default_localsocket'] %> ]; do sleep 1; done"
ExecStart=/usr/bin/clamonacc -F<% if scope['clamav::clamonacc_default_logfile'] %> --log=<%= scope['clamav::clamonacc_default_logfile'] %><% end %><% if scope['clamav::clamonacc_quarantine_dir'] %> --move=<%= scope['clamav::clamonacc_quarantine_dir'] %><% end %>

[Install]
WantedBy=multi-user.target
